(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{480:function(o,v,a){"use strict";a.r(v);var i=a(1),e=Object(i.a)({},(function(){var o=this,v=o.$createElement,a=o._self._c||v;return a("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[a("h1",{attrs:{id:"nacos-常见问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nacos-常见问题"}},[o._v("#")]),o._v(" Nacos 常见问题")]),o._v(" "),a("h2",{attrs:{id:"_1-failover-switch-is-not-found-failover00-00-000-vipsrv-failover-switch-000-00-00"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-failover-switch-is-not-found-failover00-00-000-vipsrv-failover-switch-000-00-00"}},[o._v("#")]),o._v(" [1]failover switch is not found, failover00-00---000-VIPSRV_FAILOVER_SWITCH-000---00-00")]),o._v(" "),a("p",[o._v("将Nacos日志设置到Debug级别，在服务运行起来之后，就会发现控制台持续输出以上Debug信息。")]),o._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[o._v("说明")]),o._v(" "),a("p",[o._v("这不是代码Bug，而是Nacos自身机制，想要详细了解请阅读Nacos源代码或自行百度。")])]),o._v(" "),a("p",[o._v("这是Nacos Client本地缓存及故障转移机制。在Nacos源代码中，ServiceInfoHolder的构造方法中，会初始化一个FailoverReactor类。FailoverReactor的作用便是用来处理故障转移的。")]),o._v(" "),a("p",[o._v("FailoverReactor的构造方法会拼接故障根目录：${user.home}/nacos/naming/public/failover，其中public也有可能是其他的自定义命名空间；")]),o._v(" "),a("p",[o._v("主要逻辑就是：")]),o._v(" "),a("ul",[a("li",[a("p",[o._v("基本操作就是读取failover目录，查找故障转移【开关】文件为名为“failover00-00---000-VIPSRV_FAILOVER_SWITCH-000---00-00”。")])]),o._v(" "),a("li",[a("p",[o._v("如果故障转移文件不存在，则直接返回，不断输出Debug信息。")])]),o._v(" "),a("li",[a("p",[o._v("如果故障转移文件存在，比较文件修改时间，如果已经修改，则获取故障转移文件中的内容。")])]),o._v(" "),a("li",[a("p",[o._v("故障转移文件中存储了0和1标识。0表示关闭，1表示开启。")])]),o._v(" "),a("li",[a("p",[o._v("当为开启状态时，执行线程FailoverFileReader。")])]),o._v(" "),a("li",[a("p",[a("strong",[o._v("解决办法")])])])]),o._v(" "),a("ol",[a("li",[o._v("将Nacos日志级别调整为INFO级别以上。")]),o._v(" "),a("li",[o._v("手动在"),a("code",[o._v("${user.home}/nacos/naming/public")]),o._v("目录下，新建文件"),a("code",[o._v("failover00-00---000-VIPSRV_FAILOVER_SWITCH-000---00-00")]),o._v("。")])])])}),[],!1,null,null,null);v.default=e.exports}}]);